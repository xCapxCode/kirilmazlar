# ===========================================
# KIRIILMAZLAR PANEL - DEVELOPMENT DOCKERFILE
# Hot-reload development environment
# ===========================================

FROM node:18-alpine AS development

# Install development tools
RUN apk add --no-cache \
    git \
    curl \
    bash

# Set working directory
WORKDIR /app

# Create non-root user
RUN addgroup -g 1001 -S nodejs && \
    adduser -S kirilmazlar -u 1001

# Copy package files
COPY package*.json ./

# Install all dependencies (including devDependencies)
RUN npm ci --silent

# Copy source code
COPY . .

# Set ownership
RUN chown -R kirilmazlar:nodejs /app

# Switch to non-root user
USER kirilmazlar

# Expose development server port
EXPOSE 5500

# Health check for development
HEALTHCHECK --interval=30s --timeout=3s --start-period=10s --retries=3 \
    CMD curl -f http://localhost:5500 || exit 1

# Start development server
CMD ["npm", "run", "dev"]

# Metadata
LABEL maintainer="GeniusCoder (Gen)" \
      version="1.0.0-dev" \
      description="Kırılmazlar Panel - Development Environment"
